# renesas_ek4m3_cmake
Structure for building Renesas FSP and other dependencies with CMake, with minimal dependency

## Dependencies
There are multiple dependencies for this repo and project. 
The repo contains several submodules, which can be initiated by running the `setup_repo.sh` script.  

Moreover, the Renesas toolchain and compiler must be installed, which can be done either by installing RA smart configurator, 
or E2 Studio. 

The path to the installed GCC EWARM compiler must be set in `config.cmake`. 

Moreover, CMake version 3.16.4 or later must be installed. This repo was developed on Windows using VScode and MinGW, your mileage may vary. 

NOTE: Some files generated by Renesas configuration tool is included in `firmware/inc`, and is the IP of Renesas, and not written by me. 
If there needs to be a change in the configuration, the files in the `inc` folder(s) needs to be updated, and the appropriate CMakeLists.txt files needs to be generated for that platform. 
The intention of this project is not to support all Renesas MCU's, rather an exploration to use build tools that are compatible with a wider range of usecases, rather than using a custom Eclipse based IDE. 

## Building
Building this project is fairly simple. Calling `build.sh` under the specific platform will (re)configure CMake and build the project. 

## Cmake files
There are three important files related to this repo, namely:

- `config.cmake`
- `CMakeLists.txt`
- `<platform>-renesas-gcc-arm-none-eabi.cmake`

`config.cmake` contains repo-wide and system wide settings, such as the absolute path to the compiler, and other dependencies that relate to the system the codebase is being built on. This will have to be configured by the user of this repo. This is aimed to be hardware agnostic, but since this is building for a Renesas MCU, some assumptions can be made. E.g., it does not make sense to re-use this repo for another vendor. 

`CmakeLists.txt` is the per-build file that specifies dependencies for each intended build file. This should be where the specific dependencies of one target build exists, such as included files etc. 

`<platform>-gcc-arm-none-eabi.cmake` This is the toolchain file for a specific MCU, and contains the build specifications for that MCU type. For example, if two firmware projects reuse the same MCU, the same toolchain file can be reused. Therefore, this file content is only specific to the MCU platform, but project-agnostic. 

## Source files
Under the `firmware` directory, there are one subfolder for each project. These can use different MCU's but this repo was built for the targets under "Supported targets", hence those have been tested here. 

Each project directory contains at least three sub-directories; ^`src`, `inc` and `build`. `src` contains the source files custom to this project, typically the main file and other custom build files. `inc` contains generated header files, which are generated by the Renesas RA Smart Configurator or other configuration tools, or hand built if that's the case. These are typically the BSP files, and other platform specific files. 
Finally, the `build` directory is where CMake places its build files, and where the compiled target file is located. 

There may be other files included in the project directory as well, which shall be explained the project's own readme file. 

## Supported targets

- EK-RA4M3